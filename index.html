<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThunderChat</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
  background: linear-gradient(to bottom right, #0f172a, #0ea5e9);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  animation: fadeIn 1.5s ease-in;
  transition: background 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.input {
  @apply w-full p-3 rounded-lg border border-cyan-400 bg-white text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-400 transition duration-300;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.button {
  @apply w-full py-3 rounded-lg text-white bg-cyan-600 hover:bg-blue-700 transition duration-300 shadow-lg;
  font-weight: 600;
}

.chat-bubble {
  @apply bg-cyan-700 text-white p-3 rounded-xl shadow-lg mb-2 max-w-xs;
  animation: bubbleIn 0.3s ease-out;
}

@keyframes bubbleIn {
  from {
    transform: scale(0.95);
    opacity: 0.6;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.chat-bubble.self {
  @apply bg-blue-500 text-white ml-auto;
}

#app {
  animation: fadeIn 1s ease;
  background: linear-gradient(to bottom, #f0f9ff, #dbeafe);
  border: 2px solid #0ea5e9;
}

#messages::-webkit-scrollbar {
  width: 6px;
}

#messages::-webkit-scrollbar-thumb {
  background-color: #0ea5e9;
  border-radius: 10px;
}

   </style>
</head>

<body class="flex flex-col items-center justify-center min-h-screen p-4">
  <div id="auth-section" class="w-full max-w-sm">
    <h2 class="text-2xl font-bold mb-4 text-center">ThunderChat</h2>
    <input id="email" class="w-full p-2 mb-2 rounded bg-gray-700 text-white" type="email" placeholder="Email">
    <input id="password" class="w-full p-2 mb-2 rounded bg-gray-700 text-white" type="password" placeholder="Password">
    <button id="loginBtn" class="w-full p-2 mb-2 bg-blue-600 hover:bg-blue-700 rounded">Login</button>
    <button id="registerBtn" class="w-full p-2 mb-4 bg-green-600 hover:bg-green-700 rounded">Register</button>
  </div>

  <div id="chat-section" class="hidden w-full max-w-md">
    <div class="flex justify-between items-center mb-2">
      <h3 class="text-xl font-semibold">Group Chat</h3>
      <button id="logoutBtn" class="text-sm bg-red-600 px-3 py-1 rounded hover:bg-red-700">Logout</button>
    </div>
    <div id="chat-box" class="chat-box bg-gray-800 p-2 rounded overflow-y-auto h-80 mb-2"></div>
    <div class="flex gap-2">
      <input id="messageInput" class="flex-1 p-2 rounded bg-gray-700 text-white" type="text" placeholder="Type a message...">
      <button id="sendBtn" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded">Send</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBD4bDQgVtMd9cwq9Hfdz54NYSBcQvPr1Y",
      authDomain: "thunderboundthunderchat.firebaseapp.com",
      databaseURL: "https://thunderboundthunderchat-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "thunderboundthunderchat",
      storageBucket: "thunderboundthunderchat.appspot.com",
      messagingSenderId: "79690962383",
      appId: "1:79690962383:web:fecf12881a13a4fdf22eba"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const loginBtn = document.getElementById("loginBtn");
    const registerBtn = document.getElementById("registerBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const chatSection = document.getElementById("chat-section");
    const authSection = document.getElementById("auth-section");
    const messageInput = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendBtn");
    const chatBox = document.getElementById("chat-box");

    loginBtn.onclick = () => {
      signInWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
        .then(() => console.log("Logged in"))
        .catch(err => alert(err.message));
    };

    registerBtn.onclick = () => {
      createUserWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
        .then(() => console.log("Registered"))
        .catch(err => alert(err.message));
    };

    logoutBtn.onclick = () => {
      signOut(auth);
    };

    onAuthStateChanged(auth, user => {
      if (user) {
        authSection.classList.add("hidden");
        chatSection.classList.remove("hidden");
      } else {
        authSection.classList.remove("hidden");
        chatSection.classList.add("hidden");
      }
    });

    sendBtn.onclick = () => {
      const msg = messageInput.value.trim();
      if (msg) {
        push(ref(db, "messages"), {
          sender: auth.currentUser.email,
          text: msg
        });
        messageInput.value = "";
      }
    };

    onChildAdded(ref(db, "messages"), snapshot => {
      const { sender, text } = snapshot.val();
      const div = document.createElement("div");
      div.className = "msg";
      div.innerHTML = `<div class="sender">${sender}</div><div>${text}</div>`;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    });
  </script>
</body>

</html>
